%
% Generated at 10.03.2023 - 16:20:16 by RobotFramework_DBus
%


\hypertarget{prerequisites}{%
\section{Prerequisites}\label{prerequisites}}

Before using \textbf{RobotFramework\_DBus}, make sure you have the following libraries installed:

\begin{itemize}
  \item \textbf{pycairo}: This library provides Python bindings for the Cairo graphics library. It is used for rendering graphics and creating visual elements in your applications.
  \item \textbf{PyGObject}: PyGObject is a Python package that provides bindings for the GObject library. It allows you to use GObject-based libraries, such as GTK+, in Python applications.
  \item \textbf{dasbus}: \textbf{RobotFramework\_DBus} is built upon the \textit{dasbus} library, which is a Pythonic D-Bus library. Make sure you have \textit{dasbus} installed before using \textbf{RobotFramework\_DBus}.
  \item \textbf{pyinstaller}: PyInstaller is a tool used to package Python applications into standalone executables. If you plan to distribute your application as an executable, you will need to have \textit{pyinstaller} installed.
\end{itemize}

Ensure that the above libraries are installed and properly configured in your Python environment before using \textbf{robotframework-dbus}. This will ensure the smooth functioning and compatibility of the library with your system.

\hypertarget{getting-started}{%
\section{Getting Started}\label{getting-started}}

You can checkout all
\href{https://github.com/test-fullautomation/robotframework-dbus/}{robotframework-dbus}
sourcecode from the GitHub.

After checking out the source completely, you can install by running
below command inside \textbf{robotframework-dbus} directory.

\begin{robotlog}
python setup.py install
\end{robotlog}

\hypertarget{usage}{%
\section{Usage}\label{description-usage}}

RobotFramework\_DBus Library support following keywords for testing connection in RobotFramework.

\hypertarget{description-connect}{%
\subsection{\texorpdfstring{\textbf{connect}}{connect}}\label{description-connect}}

\begin{quote}
\textbf{Use for establishing a connection.}

\textbf{Syntax}:

\begin{robotcode}
connect		conn_name=[connection name] 
...    		namespace=[namespace] 
...    		object_path=[object path] 
...    		mode=[test mode] 
...    		host=[remote host] 
...    		port=[remote port]
\end{robotcode}

\textbf{Arguments}:

\begin{quote}
\textbf{conn\_name}: The name or identifier of the connection instance used to interact with the DBus service.
  This parameter is optional and can be used to uniquely identify a specific connection
  when multiple connections are established. If not provided, a default connection will be used.

  Default is 'default\_conn'.

\vspace{\baselineskip}

\textbf{namespace}: The namespace of the DBus service.
  This identifies the specific service or group of services.
  It is used to differentiate between different service instances.
  The namespace should be a string that uniquely identifies the service.

  E.g. namespace=org.example.HelloWorld

\vspace{\baselineskip}

\textbf{object\_path}: The object path of the DBus service.
  This identifies the specific object within the service that the action will be performed on.
  The object path should be a string that follows the DBus object path naming convention.
  It typically consists of a hierarchical structure separated by slashes (/).

  E.g. object\_path=/org/example/HelloWorld

\vspace{\baselineskip}

\textbf{mode}: The mode of testing the DBus service. Possible values are 'local' or 'remote'.
  'local' indicates testing on the current system, while 'remote' indicates testing on a remote system.

  Default is 'local'.

\vspace{\baselineskip}

\textbf{host}: The IP address or hostname of the remote system where the DBus agent is running.
                 This parameter is applicable only if `mode` is set to 'remote'.

				 Default is 'localhost'.
\end{quote}
\end{quote}

\hypertarget{description-disconnect}{%
\subsection{\texorpdfstring{\textbf{disconnect}}{disconnect}}\label{description-disconnect}}

\begin{quote}
\textbf{Use for disconnecting from the DBus service by connection name.}

\textbf{Syntax}:

\begin{robotcode}
disconnect 		conn_name
\end{robotcode}

\textbf{Arguments}:

\begin{quote}
\textbf{conn\_name}: The name or identifier of the connection instance to disconnect from.
This parameter is optional and can be used to specify a specific connection
to disconnect. If the connection name is 'ALL', all connections will be disconnected.
\end{quote}
\end{quote}

\hypertarget{description-set-signal-received-handler}{%
\subsection{\texorpdfstring{\textbf{set signal received handler}}{set signal received handler}}\label{description-set-signal-received-handler}}

\begin{quote}
\textbf{Use to set a signal received handler for a specific DBus connection and signal.}

\textbf{Syntax}:

\begin{robotcode}
set signal received handler	conn name=[conn name] 
...                        	signal=[signal name]
...                        	handler=[keyword handles signal emitted event]
\end{robotcode}

\textbf{Arguments}:

\begin{quote}
\textbf{conn\_name}: The name or identifier of the connection instance used to interact with the DBus service.
  This parameter is optional and can be used to uniquely identify a specific connection
  when multiple connections are established. If not provided, a default connection will be used.

  Default is 'default\_conn'.

\vspace{\baselineskip}

\textbf{signal}: The name of the DBus signal to be set emitted handler.

\vspace{\baselineskip}

\textbf{handler}:  The robotframework keyword to handle the received signal.
  The handler should accept the necessary parameters based on the signal being handled.
\end{quote}
\end{quote}

\hypertarget{description-unset-signal-received-handler}{%
\subsection{\texorpdfstring{\textbf{unset signal received handler}}{unset signal received handler}}\label{description-unset-signal-received-handler}}

\begin{quote}
\textbf{Use to unset a signal received handler for a specific signal.}

\textbf{Syntax}:
\begin{robotcode}
unset signal received handler 	conn name=[conn name] 
...                           	signal=[signal name]
...                           	handler=[keyword handles signal emitted event]
\end{robotcode}

\textbf{Arguments}:

\begin{quote}
\textbf{conn\_name}: The name or identifier of the connection instance used to interact with the DBus service.
  This parameter is optional and can be used to uniquely identify a specific connection
  when multiple connections are established. If not provided, a default connection will be used.

  Default is 'default\_conn'.

\vspace{\baselineskip}

\textbf{signal}: The name of the DBus signal to be unset emitted handler.

\vspace{\baselineskip}

\textbf{handler}:  The robotframework keyword which is handling the signal emitted event.
\end{quote}
\end{quote}

\hypertarget{description-register-signal}{%
\subsection{\texorpdfstring{\textbf{register signal}}{register signal}}\label{description-register-signal}}
\begin{quote}
\textbf{Use to register a DBus signal or signals to be monitored for a specific connection.}

\textbf{Syntax}:
\begin{robotcode}
register signal 	conn name=[conn name] 
...             	signal=[signal name]
\end{robotcode}

\textbf{Arguments}:

\begin{quote}
\textbf{conn\_name}: The name or identifier of the connection instance used to interact with the DBus service.
  This parameter is optional and can be used to uniquely identify a specific connection
  when multiple connections are established. If not provided, a default connection will be used.

  Default is 'default\_conn'.

\vspace{\baselineskip}

\textbf{signal}: The name of the DBus signal(s) to register. It can be a single signal name as a string,
  or multiple signal names joined by ','. For example: "signal1,signal2,signal3".
\end{quote}
\end{quote}

\hypertarget{description-call-dbus-method}{%
\subsection{\texorpdfstring{\textbf{call dbus method}}{call dbus method}}\label{description-call-dbus-method}}

\begin{quote}
\textbf{Use to call a DBus method with the specified method name and input arguments.}

\textbf{Syntax}:
\begin{robotcode}
call dbus method 	[conn name] 	[method name] 	[args]
\end{robotcode}

\textbf{Arguments}:

\begin{quote}
\textbf{conn\_name}: The name or identifier of the connection instance used to interact with the DBus service.
  This parameter is optional and can be used to uniquely identify a specific connection
  when multiple connections are established. If not provided, a default connection will be used.

  Default is 'default\_conn'.

\vspace{\baselineskip}

\textbf{method\_name}: The name of the DBus method to be called.

\vspace{\baselineskip}

\textbf{args}: Input arguments to be passed to the method.
\end{quote}

\textbf{Return value}:

\begin{quote}
\textbf{Return from called method.}
\end{quote}
\end{quote}


\hypertarget{description-wait-for-signal}{%
\subsection{\texorpdfstring{\textbf{wait for signal}}{wait for signal}}\label{description-wait-for-signal}}

\begin{quote}
\textbf{Use to wait for a specific DBus signal to be received within a specified timeout period.}

\textbf{Syntax}:
\begin{robotcode}
wait for signal 	conn name=[conn name] 
...             	signal=[signal name] 
...             	timeout=[timeout]
\end{robotcode}

\textbf{Arguments}:

\begin{quote}
\textbf{conn\_name}: The name or identifier of the connection instance used to interact with the DBus service.
  This parameter is optional and can be used to uniquely identify a specific connection
  when multiple connections are established. If not provided, a default connection will be used.

  Default is 'default\_conn'.

\vspace{\baselineskip}

\textbf{signal}: The name of the DBus signal to wait for.

\vspace{\baselineskip}

\textbf{timeout}: The maximum time (in seconds) to wait for the signal.
\end{quote}

\textbf{Return value}:

\begin{quote}
\textbf{The signal payloads.}
\end{quote}
\end{quote}

\hypertarget{remote-testing}{%
\section{Remote testing}\label{remote-testing}}

After installing the library, you can find the DBus Client Agent at \texttt{/opt/rfwaio/python39/install/bin/}.

For remote testing, follow these steps:

\begin{enumerate}
    \item Start the DBus Agent on the remote system by the following command:

		\textbf{dbus\_client\_agent} [-h] [--host HOST] [--port PORT]

		The DBus Client Agent supports the following command-line arguments:

		\begin{itemize}
			\setlength{\itemindent}{10em}
			\item [\texttt{--host} (str, optional)] The host where the agent is running. Default is \texttt{0.0.0.0}.
			\item [\texttt{--port} (int, optional)] The port where the agent is listening. Default is 2507.
		\end{itemize}


    \item On the host test PC, using the \texttt{connect} keyword with the \texttt{remote} mode and specify the correct host using the \texttt{host} parameter.
    \item Use the other keywords in the same way as local testing.
\end{enumerate}


\hypertarget{example}{%
\section{Example}\label{example}}


Kindly be advised that all the examples presented within this session are designed to interact with the DBus service sample server.py residing in the atest/ directory.

\newpage
\hypertarget{description-example1}{%
\subsection{\texorpdfstring{\textbf{Example 1 - Synchronized DBus Signal Waiting}}{Example 1 - Synchronized DBus Signal Waiting}}\label{description-example1}}

\textbf{Scenario:} 
In this example, I will use the \rcode{wait for signal} keyword from the RobotFramework\_DBus library to wait for a DBus signal to be emitted using the synchronized mechanism.
This means that the keyword following \rcode{wait for signal} will only be executed after the signal is emitted, and the \rcode{wait for signal} keyword will return a value.


\begin{robotcode}
*** Settings ***
Library    RobotFramework_DBus.DBusManager

*** Test Cases ***
Hello World
   connect    conn_name=test_dbus
   ...        namespace=org.example.HelloWorld
   ...        mode=local

   ${ret}=    Wait For Signal     conn_name=test_dbus
   ...                            signal=YellowMessage
   ...                            timeout=10

   Log To Console    ${ret}

   Disconnect    test_dbus
\end{robotcode}

\textbf{Explanation:}
In the aforementioned example, we establish a connection to the DBus service \rcode{org.example.HelloWorld} using the \rcode{'connect'} keyword and name this connection '\textbf{test\_dbus}'.
Subsequently, the \textbf{'Wait for signal'} keyword will wait for the DBus service to emit the \textbf{YellowMessage} signal within a 10-second timeframe and return the payloads of this signal
immediately upon its emission within the specified timeframe (failing if the timeout is exceeded). The content of the payloads will be printed to the console.

\hypertarget{description-example2}{%
\subsection{\texorpdfstring{\textbf{Example 2 - Managing Multiple DBus Signals with 'Register Signal' Keyword}}{Example 2 - Managing Multiple DBus Signals with 'Register Signal' Keyword}}\label{description-example2}}

\textbf{Scenario:}
In Example 1, if we include an additional \rcode{Wait for signal} keyword to wait for the \textbf{GreenMessage} signal to be emitted after waiting for \textbf{YellowMessage},
there is a possibility of missing the occurrence of \textbf{GreenMessage} if it is emitted before \textbf{YellowMessage}. In such a scenario, we can utilize the \rcode{Register Signal}
keyword to register \textbf{GreenMessage} in the watchlist. This ensures continuous monitoring of the signal starting immediately after executing this keyword and prevents the occurrence
of missing the emitted \textbf{GreenMessage} event.


\begin{robotcode}
*** Settings ***
Library    RobotFramework_DBus.DBusManager

*** Test Cases ***
Hello World
   connect    conn_name=test_dbus
   ...        namespace=org.example.HelloWorld
   ...        mode=local

   Register Signal    conn_name=test_dbus    signal=GreenMessage

   ${ret}=    Wait For Signal     conn_name=test_dbus
   ...                            signal=YellowMessage
   ...                            timeout=10
   Log To Console    ${ret}

   ${ret}=    Wait For Signal     conn_name=test_dbus
   ...                            signal=GreenMessage
   ...                            timeout=10
   Log To Console    ${ret}

   ${ret}=    Call Dbus Method    test_dbus    Hello    World
   Disconnect    test_dbus
\end{robotcode}

\textbf{Explanation:}

In the above example, by using the \textbf{Register Signal} keyword, we have registered the \textbf{GreenMessage} signal in the watchlist. If the \textbf{GreenMessage} event is emitted
during the \textbf{Wait for signal YellowMessage} timeframe, it will be recorded. Then, when we execute the \rcode{Wait for signal} keyword for \textbf{GreenMessage}, it will immediately return
because the \textbf{GreenMessage} event has already occurred.


\hypertarget{description-example3}{%
\subsection{\texorpdfstring{\textbf{Example 3 - Non-blocking DBus Signal Handling with 'Set Signal Received Handler'}}{Example 3 - Non-blocking DBus Signal Handling with 'Set Signal Received Handler'}}\label{description-example3}}

\textbf{Scenario:}
In the two examples above, the testcase is blocked at the \rcode{Wait for Signal} keyword until the signal event is emitted. In the next example, we will explore the usage of
the \rcode{Set Signal Received Handler} keyword. This is a non-blocking keyword that allows us to register a user-defined keyword, such as a callback function. The registered
keyword will be called when the emitted signal event occurs. The testcase will continue with the next keyword immediately after the \rcode{Set Signal Received Handler} keyword, without waiting.


\begin{robotcode}
*** Settings ***
Library    RobotFramework_DBus.DBusManager
Library    test/dbus/client.py

*** Test Cases ***
Hello World
   connect    conn_name=test_dbus
   ...        namespace=org.example.HelloWorld
   ...        mode=local

   Set Signal Received Handler    conn_name=test_dbus
   ...                            signal=RedMessage
   ...                            handler=On Received Red Signal

   Log To Console    The test is continuing...

   Sleep    10s

   Disconnect    test_dbus

*** Keyword ***
On Received Red Signal
   [Arguments]    ${arg1}=default 1
   log to console      Client received red signal. Payload: ${arg1}
   Unset Signal Received Handler    conn_name=test_dbus    signal=RedMessage    handler=On Received Red Signal
\end{robotcode}

\textbf{Explanation:}

In the above example, by using the \rcode{Set Signal Received Handler} keyword, we have registered the user-defined keyword \rcode{On Received Red Signal} as a callback function.
When the \textbf{RedMessage} is emitted, this keyword will be executed. During the time when the \textbf{RedMessage} has not been emitted yet, the testcase will continue running the
subsequent keywords as usual. It is important to note that the user-defined keyword should have an argument to handle the payload of the signal. If there is no longer a need to invoke
the callback function, we should unregister the signal handler using the \rcode{Unset Signal Received Handler} keyword.


\newpage
\hypertarget{description-example4}{%
\subsection{\texorpdfstring{\textbf{Example 4 - Invoking DBus Methods: Using 'Call Dbus Method' Keyword}}{Example 4 - Invoking DBus Methods: Using 'Call Dbus Method' Keyword}}\label{description-example4}}

\textbf{Scenario:}

In the next example, we will explore how to use the \rcode{Call Dbus Method} keyword to invoke a method in the DBus service and retrieve the return value from this method.


\begin{robotcode}
*** Settings ***
Library    RobotFramework_DBus.DBusManager
Library    test/dbus/client.py

*** Test Cases ***
Hello World
   connect    conn_name=test_dbus
   ...        namespace=org.example.HelloWorld
   ...        mode=local

   ${ret}=    Call Dbus Method    test_dbus    Hello    World
   Log To Console    ${ret}

   Disconnect    test_dbus
\end{robotcode}


\hypertarget{description-example5}{%
\subsection{\texorpdfstring{\textbf{Example 5 - Testing a Remote DBus Service: Setup and Steps}}{Example 5 - Testing a Remote DBus Service: Setup and Steps}}\label{description-example5}}

\textbf{Scenario:}
In the next example, we will explore how to test a DBus service on a different PC. To be able to test on a remote system, we need to perform two steps:

\begin{enumerate}
\item On the System Under Test (SUT), run the following command:

	\textbf{dbus\_client\_agent}  0.0.0.0  2507

		The DBus Client Agent supports the following command-line arguments:

		\begin{itemize}
			\setlength{\itemindent}{10em}
			\item [\texttt{--host} (str, optional)] The host where the agent is running. Default is \texttt{0.0.0.0}.
			\item [\texttt{--port} (int, optional)] The port where the agent is listening. Default is 2507.
		\end{itemize}

\item On the test PC, make slight modifications to the keyword's connect parameters as follows:
\end{enumerate}

\begin{robotcode}
*** Settings ***
Library    RobotFramework_DBus.DBusManager
Library    test/dbus/client.py

*** Test Cases ***
Hello World
   connect    conn_name=test_dbus
   ...        namespace=org.example.HelloWorld
   ...        mode=remote
   ...        host=172.17.0.2
   ...        port=2507

   Set Signal Received Handler    conn_name=test_dbus
   ...                            signal=RedMessage
   ...                            handler=On Received Red Signal

   Log To Console    The test is continuing...

   Sleep    10s

   Disconnect    test_dbus

*** Keyword ***
On Received Red Signal
   [Arguments]    ${arg1}=default 1
   log to console      Client received red signal. Payload: ${arg1}
   Unset Signal Received Handler    conn_name=test_dbus    signal=RedMessage    handler=On Received Red Signal
\end{robotcode}

\textbf{Explanation:}

In the above example, we set the value of the \texttt{mode} parameter for the \texttt{connect} keyword to \texttt{remote}, and add two parameters: \texttt{host}
and \texttt{port}. The \texttt{host} parameter is set to the IP address of the System Under Test (SUT), which is 172.17.0.2, and the \texttt{port} parameter is set
to 2507, which is the port that the agent is listening on.


\hypertarget{configure-git-and-correct-eol-handling}{%
\section{Configure Git and correct EOL
handling}\label{configure-git-and-correct-eol-handling}}

Here you can find the references for
\href{https://help.github.com/articles/dealing-with-line-endings/}{Dealing
with line endings}.

Every time you press return on your keyboard you're actually inserting
an invisible character called a line ending. Historically, different
operating systems have handled line endings differently. When you view
changes in a file, Git handles line endings in its own way. Since you're
collaborating on projects with Git and GitHub, Git might produce
unexpected results if, for example, you're working on a Windows machine,
and your collaborator has made a change in OS X.

To avoid problems in your diffs, you can configure Git to properly
handle line endings. If you are storing the .gitattributes file directly
inside of your repository, than you can asure that all EOL are manged by
git correctly as defined.


\hypertarget{feedback}{%
\section{Feedback}\label{feedback}}

If you have any problem when using the library or think there is a
better solution for any part of the library, I'd love to know it, as
this will all help me to improve the library. Connect with me at
\href{mailto:cuong.nguyenhuynhtri@vn.bosch.com}{\nolinkurl{cuong.nguyenhuynhtri@vn.bosch.com}}.

Do share your valuable opinion, I appreciate your honest feedback!

\hypertarget{about}{%
\section{About}\label{about}}

\hypertarget{maintainers}{%
\subsection{Maintainers}\label{maintainers}}

\href{cuong.nguyenhuynhtri@vn.bosch.com}{Nguyen Huynh Tri Cuong}

\hypertarget{contributors}{%
\subsection{Contributors}\label{contributors}}

\href{cuong.nguyenhuynhtri@vn.bosch.com}{Nguyen Huynh Tri Cuong}

\href{thomas.pollerspoeck@de.bosch.com}{Thomas Pollerspoeck}

\hypertarget{rd-party-licenses}{%
\subsection{3rd Party Licenses}\label{rd-party-licenses}}

You must mention all 3rd party licenses (e.g.~OSS) licenses used by your
project here. Example:

\begin{longtable}[]{@{}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.3623}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.5362}}
  >{\raggedright\arraybackslash}p{(\columnwidth - 4\tabcolsep) * \real{0.0942}}@{}}
\toprule()
\begin{minipage}[b]{\linewidth}\raggedright
Name
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
License
\end{minipage} & \begin{minipage}[b]{\linewidth}\raggedright
Type
\end{minipage} \\
\midrule()
\endhead
\href{http://felix.apache.org/}{Apache Felix}. &
\href{http://www.apache.org/licenses/LICENSE-2.0.txt}{Apache 2.0
License}. & Dependency \\
\bottomrule()
\end{longtable}

\hypertarget{used-encryption}{%
\subsection{Used Encryption}\label{used-encryption}}

Declaration of the usage of any encryption (see BIOS Repository Policy
§4.a).

\hypertarget{license}{%
\subsection{License}\label{license}}
% \protect\hyperlink{license}{\includegraphics{pictures/bioslv4-badge.png}}

\begin{quote}
Copyright (c) 2009, 2018 Robert Bosch GmbH and its subsidiaries. This
program and the accompanying materials are made available under the
terms of the Bosch Internal Open Source License v4 which accompanies
this distribution, and is available at
\url{http://bios.intranet.bosch.com/bioslv4.txt}
\end{quote}
